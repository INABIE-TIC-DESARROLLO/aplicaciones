<!DOCTYPE html>
<html lang="en">
    <head>
        {% load static %}
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>RRHH - Panel Permisos Encargados</title>
        <link rel="icon" href="{% static 'imagenes/logo.jpg' %}">
        <link rel="stylesheet" href="{% static '/bootstrap-5.1.3-dist/css/bootstrap.css' %}">
        
        <style>
            /* Estilos de base para todas las paginas - Inicio */
            button{
                transform: scale(1);
                transition: transform .15s linear;
                padding: .5rem;
                border: none;
                border-radius: .3rem;
            }

            button:hover{
                transform: scale(1.1);
            }

            .action-button{
                background-color: #1f3c73;
                color: aliceblue;
                
                
            }

            .encabezado{
                display: flex;
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
                margin: 3rem 2rem;
            }

            .encabezado img{
                width: 30%;
                position: relative;
                left: 0;
                animation: animacion-logo 1s linear;
            }

            .texto-encabezado{
                color: #1f3c73;
            }

            @keyframes animacion-degradado {
                from{
                    background-color: #ececec;
                }

                to{
                    background-color: white;
                }
            }

            @keyframes animacion-logo {
                from{
                    left: -500px;
                }

                to{
                    left: 0;
                }
            }

            /* Estilos de base para todas las paginas - Fin */

            table{
                margin: 2rem;
                border-collapse: separate;
                border-spacing: 0 1rem;
                padding: 1rem;
                border: 1px solid rgb(241, 241, 241);
                border-radius: 2rem;
                /* background: linear-gradient(to top right, #ececec, white); */
                animation: animacion-degradado 3s linear infinite alternate;
            
                
            }

            td, th{
                border-bottom: 1px solid rgb(228, 228, 228);
                padding: .5rem;
            }

            th{
                color: #1f3c73;
            }

            .aprobado{
                /* background: linear-gradient(to right bottom, rgb(6, 160, 6), rgb(65, 212, 65)); */
                color: rgb(12, 209, 12);
                font-weight: bold;
                border-radius: .5rem;
            }

            .denegado{
                /* background: linear-gradient(to right bottom, rgb(155, 9, 40), rgb(216, 80, 80)); */
                color: rgb(201, 14, 14);
                font-weight: bold;
                border-radius: .5rem;
            }

            .pendiente{
                /* background: linear-gradient(to right bottom, rgb(160, 132, 6), rgb(253, 217, 55)); */
                color: rgb(206, 169, 7);
                font-weight: bold;
                border-radius: .5rem;
            }

            .boton-nuevo-permiso{
                position: fixed;
                bottom: 5%;
                right: 5%;
                width: 75px;
                height: 75px;
                border-radius: 50%;
                background: linear-gradient(45deg, #778bb1, #1d283b);
                font-size: 3rem;
                display: flex;
                justify-content: center;
                align-items: center;
                color: aliceblue;
                padding: 0;
                border: 1px solid #1f3c73;
            

            }

        </style>

    </head>
    <body>

        <div class="encabezado">
        
            <img src="{% static './imagenes/logo-inabie-izquierda.png'%}" alt="">
            
            <div class="texto-encabezado">
                <h1>Herramienta de Administración de Permisos</h1>
                <p class="card-text">Si usted es encargado de algún departamento podrá ver las solicitud de permisos que han hecho sus subordinados, aprobarlas, denegarlas y consultarlas por medio de filtros...</p>
            </div>
            
            <div>
                <button class="action-button" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvas" aria-controls="offcanvas">Opciones y filtros</button>
 
            </div>
            
            
        </div>


        <table>
            <thead>
                <tr>
                    <th>Id Permiso</th>
                    <th>Nombre Empleado</th>
                    <th>Cargo Empleado</th>
                    <th>Fecha Solicitud</th>
                    <th>Fecha Permiso</th>
                    <th>Desde (Hora)</th>
                    <th>Hasta (Hora)</th>
                    <th>Justificación</th>
                    <th>Estado</th>
                    <th>Comentario/Acciones</th>
                </tr>
            </thead>
            <tbody>

                {% for permiso in permisos %}
                    {% if permiso.estado == 'PENDIENTE' %}
                        <tr>
                            <td>{{permiso.id}}</td>
                            <td>{{permiso.empleado}}</td>
                            <td>{{permiso.empleado.cargo}}</td>
                            <td>{{permiso.fecha_solicitud}}</td>
                            <td>{{permiso.fecha_permiso}}</td>
                            <td>{{permiso.desde_hora}}</td>
                            <td>{{permiso.hasta_hora}}</td>
                            <td class="text-wrap text-break w-25">{{permiso.justificacion}}</td>
                            <td class="pendiente">{{permiso.estado}}</td>
                            
                            <td>
                                <form action="" method="post">
                                    {% csrf_token %}
                                    <div class="form-group mb-3">
                                        <label for="exampleInputEmail1">Comentario</label>
                                        <textarea class="form-control" id="comentario" name="comentario" aria-describedby="comentario-help" placeholder="" rows="3" required></textarea>

                                    </div>
                                    <button type="submit" class="btn btn-success btn-sm" name="permiso-aprobado" value="{{permiso.id}}">Aprobar</button>
                                    <button type="submit" class="btn btn-danger btn-sm" name="permiso-denegado" value="{{permiso.id}}">Denegar</button>


                                </form>
                                
                            </td>
                        </tr>
                    
                    {% endif %}
                    {% if permiso.estado == 'APROBADO' %}
                        <tr>
                            <td>{{permiso.id}}</td>
                            <td>{{permiso.empleado}}</td>
                            <td>{{permiso.empleado.cargo}}</td>
                            <td>{{permiso.fecha_solicitud}}</td>
                            <td>{{permiso.fecha_permiso}}</td>
                            <td>{{permiso.desde_hora}}</td>
                            <td>{{permiso.hasta_hora}}</td>
                            <td class="text-wrap text-break w-25">{{permiso.justificacion}}</td>
                            <td class="aprobado">{{permiso.estado}}</td>
                            
                            {% if permiso.comentario %}
                                <td class="text-wrap text-break w-25">{{permiso.comentario}}</td>
                            {% else %}
                                <td> - </td>
                            {% endif %}
                        </tr>
                    
                    {% endif %}
                    {% if permiso.estado == 'DENEGADO' %}
                        <tr>
                            <td>{{permiso.id}}</td>
                            <td>{{permiso.empleado}}</td>
                            <td>{{permiso.empleado.cargo}}</td>
                            <td>{{permiso.fecha_solicitud}}</td>
                            <td>{{permiso.fecha_permiso}}</td>
                            <td>{{permiso.desde_hora}}</td>
                            <td>{{permiso.hasta_hora}}</td>
                            <td class="text-wrap text-break w-25">{{permiso.justificacion}}</td>
                            <td class="denegado">{{permiso.estado}}</td>

                            {% if permiso.comentario %}
                                <td class="text-wrap text-break w-25">{{permiso.comentario}}</td>
                            {% else %}
                                <td> - </td>
                            {% endif %}
                            
                        </tr>
                    
                    {% endif %}
                    
                
                {% endfor %}

                

            </tbody>
            
        </table>

        <div class="offcanvas offcanvas-start" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="offcanvas" aria-labelledby="offcanvasLabel">
            <div class="offcanvas-header">
              <h5 class="offcanvas-title" id="offcanvasLabel">Opciones y filtros</h5>
              <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>

            
            <div class="offcanvas-body">
                <form action="" method="post">
                    {% csrf_token %}
                    <p class="mt-3"><strong>Estado</strong></p>

                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="permisos" id="todos" value="todos" checked>
                        <label class="form-check-label" for="todos">
                          Todos
                        </label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="permisos" id="pendientes" value="PENDIENTE">
                        <label class="form-check-label" for="pendientes">
                          Pendientes
                        </label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="permisos" id="aprobados" value="APROBADO">
                        <label class="form-check-label" for="aprobados">
                          Aprobados
                        </label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="permisos" id="denegados" value="DENEGADO">
                        <label class="form-check-label" for="denegados">
                          Denegados
                        </label>
                    </div>
                    
                    

                    <div class="mt-3">
                        <label for="fecha-solicitud" class="form-label"><strong>Fecha solicitud</strong></label>
                        <input type="date" class="form-control" id="fecha-solicitud" name="fecha_solicitud">
                    </div>

                    <div class="mt-3">
                        <label for="fecha-permiso" class="form-label"><strong>Fecha permiso</strong></label>
                        <input type="date" class="form-control" id="fecha-permiso" name="fecha_permiso">
                    </div>

                    <p class="mt-3"><strong>Empleado</strong></p>

                    <select class="form-select mt-3" aria-label="Default select example" name="empleado">
                        <option selected>TODOS</option>
                        {% for empleado in empleados %}
                            <option value="{{empleado.cedula}}">{{empleado}}</option>
                        {% endfor %}
                        
                        
                    </select>

                    <div class="d-grid gap-2 mt-3">
                        <button type="submit" class="btn btn-primary">Consultar</button>
                    </div>

                </form>

                
                
            </div>

        </div>

        <a href="/rrhh/formulario-permisos" target="_blank" rel="noopener noreferrer">
            <button class="boton-nuevo-permiso">+</button>
        </a>

        
        <script src="{% static '/jquery-3.6.0.js' %}"></script>
        <script src="{% static '/popper.min.js' %}"></script>
        <script src="{% static '/bootstrap-5.1.3-dist/js/bootstrap.js' %}"></script>
        

       
        
    </body>
</html>